<?xml version="1.0" encoding="utf-8"?>
<klayout-macro>
 <description>Bridged waveguide example</description>
 <version/>
 <category>pymacros</category>
 <prolog/>
 <epilog/>
 <doc/>
 <autorun>false</autorun>
 <autorun-early>false</autorun-early>
 <shortcut/>
 <show-in-menu>false</show-in-menu>
 <group-name/>
 <menu-path/>
 <interpreter>python</interpreter>
 <dsl-interpreter-name/>
 <text># Copyright (c) 2019-2020 IQM Finland Oy.
#
# All rights reserved. Confidential and proprietary.
#
# Distribution or reproduction of any information contained herein is prohibited without IQM Finland Oyâ€™s prior
# written permission.

import pya

import kqcircuits.util.macro_prepare as macroprep
from kqcircuits.defaults import default_layers
from kqcircuits.elements.waveguide_coplanar_bridged import NodeType, Node, WaveguideCoplanarBridged


(layout, layout_view, cell_view) = macroprep.prep_empty_layout()
top_cell = layout.create_cell("Top Cell")
cell_view.cell_name=top_cell.name     # Shows the new cell

nodes = [
    Node(NodeType.AB_SERIES_SINGLE, pya.DPoint(0,-100), a=20, b=30),
    Node(NodeType.WAVEGUIDE, pya.DPoint(200,200)),
    Node(NodeType.AB_CROSSING_BEFORE, pya.DPoint(350,0)),
    Node(NodeType.AB_SERIES_SINGLE, pya.DPoint(500,0)),
    Node(NodeType.WAVEGUIDE, pya.DPoint(750,0)),
    Node(NodeType.AB_SERIES_SET, pya.DPoint(700,-250)),
    Node(NodeType.WAVEGUIDE, pya.DPoint(650,-500)),
    Node(NodeType.AB_SERIES_SINGLE, pya.DPoint(250,-500), a=20, b=30)
]



#nodes = [
#    Node(NodeType.WAVEGUIDE, pya.DPoint(650,-500)),
#    Node(NodeType.AB_SERIES_SINGLE, pya.DPoint(250,-500), a=20, b=30)
#]

wg = WaveguideCoplanarBridged.create(layout, nodes=nodes)


top_cell.insert(pya.DCellInstArray(wg.cell_index(), pya.DTrans()))


length = WaveguideCoplanarBridged.get_length(wg, layout.layer(default_layers["annotations"]))
print("Length of the generated waveguide: {} um".format(length))</text>
</klayout-macro>
